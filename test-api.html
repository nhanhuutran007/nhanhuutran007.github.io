<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Google Apps Script API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
        }

        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f9f9f9;
            border-left: 4px solid #4CAF50;
        }

        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background: #45a049;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 12px;
        }

        .success {
            border-color: #4CAF50;
            background: #f1f8f4;
        }

        .error {
            border-color: #f44336;
            background: #fef1f0;
        }

        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üß™ Test Google Apps Script API</h1>

        <div class="info">
            <strong>üìå API URL hi·ªán t·∫°i:</strong><br>
            <code id="current-url"></code>
        </div>

        <!-- Test 1: GET Request -->
        <div class="test-section">
            <h2>Test 1: GET Request (L·∫•y testimonials)</h2>
            <p>Ki·ªÉm tra xem API c√≥ tr·∫£ v·ªÅ d·ªØ li·ªáu kh√¥ng</p>
            <button onclick="testGet()">üîç Test GET</button>
            <div id="get-result" class="result" style="display:none;"></div>
        </div>

        <!-- Test 2: POST Request -->
        <div class="test-section">
            <h2>Test 2: POST Request (G·ª≠i testimonial)</h2>
            <p>Ki·ªÉm tra xem c√≥ g·ª≠i ƒë∆∞·ª£c testimonial kh√¥ng</p>
            <input type="text" id="test-name" placeholder="T√™n (v√≠ d·ª•: Test User)" value="Test User">
            <input type="text" id="test-position" placeholder="Ch·ª©c v·ª• (v√≠ d·ª•: Tester)" value="Tester">
            <input type="text" id="test-content" placeholder="N·ªôi dung (√≠t nh·∫•t 10 k√Ω t·ª±)"
                value="This is a test testimonial from debug page">
            <button onclick="testPost()">üì§ Test POST</button>
            <div id="post-result" class="result" style="display:none;"></div>
        </div>

        <!-- Test 3: Direct Browser Test -->
        <div class="test-section">
            <h2>Test 3: M·ªü API tr·ª±c ti·∫øp trong browser</h2>
            <p>Click n√∫t n√†y ƒë·ªÉ m·ªü API URL trong tab m·ªõi. B·∫°n s·∫Ω th·∫•y JSON response n·∫øu API ho·∫°t ƒë·ªông.</p>
            <button onclick="openApiInBrowser()">üåê M·ªü API trong Browser</button>
        </div>

        <!-- Instructions -->
        <div class="info">
            <h3>üìù H∆∞·ªõng d·∫´n:</h3>
            <ol>
                <li>Ch·∫°y <strong>Test 1</strong> tr∆∞·ªõc ƒë·ªÉ ki·ªÉm tra GET request</li>
                <li>N·∫øu Test 1 th√†nh c√¥ng, ch·∫°y <strong>Test 2</strong> ƒë·ªÉ ki·ªÉm tra POST request</li>
                <li>N·∫øu c·∫£ 2 test ƒë·ªÅu l·ªói, click <strong>Test 3</strong> ƒë·ªÉ m·ªü API trong browser</li>
                <li>Ki·ªÉm tra Console (F12) ƒë·ªÉ xem chi ti·∫øt l·ªói</li>
            </ol>
        </div>
    </div>

    <script>
        // ‚ö†Ô∏è THAY ƒê·ªîI URL N√ÄY TH√ÄNH APPS SCRIPT URL C·ª¶A B·∫†N
        const API_URL = 'https://script.google.com/macros/s/AKfycbyNikXWfkkew9O8kT957_JH8fytrxDnP-_J4ZqLd60XcOBTsSNzQeBgBGJB17r4UVCn/exec';

        // Hi·ªÉn th·ªã URL hi·ªán t·∫°i
        document.getElementById('current-url').textContent = API_URL;

        // Test GET Request
        async function testGet() {
            const resultDiv = document.getElementById('get-result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            resultDiv.textContent = '‚è≥ ƒêang g·ª≠i GET request...';

            try {
                console.log('Sending GET request to:', API_URL);

                const response = await fetch(API_URL, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);

                const text = await response.text();
                console.log('Response text:', text);

                let result;
                try {
                    result = JSON.parse(text);
                } catch (e) {
                    throw new Error('Response kh√¥ng ph·∫£i JSON: ' + text);
                }

                resultDiv.className = 'result success';
                resultDiv.textContent = '‚úÖ GET Request th√†nh c√¥ng!\n\n' +
                    'Status: ' + response.status + '\n' +
                    'Response:\n' + JSON.stringify(result, null, 2);

            } catch (error) {
                console.error('GET Error:', error);
                resultDiv.className = 'result error';
                resultDiv.textContent = '‚ùå GET Request th·∫•t b·∫°i!\n\n' +
                    'Error: ' + error.message + '\n\n' +
                    'Chi ti·∫øt:\n' + error.stack;
            }
        }

        // Test POST Request
        async function testPost() {
            const resultDiv = document.getElementById('post-result');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            resultDiv.textContent = '‚è≥ ƒêang g·ª≠i POST request...';

            const data = {
                name: document.getElementById('test-name').value,
                position: document.getElementById('test-position').value,
                content: document.getElementById('test-content').value
            };

            try {
                console.log('Sending POST request to:', API_URL);
                console.log('Data:', data);

                const response = await fetch(API_URL, {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                console.log('Response status:', response.status);

                const text = await response.text();
                console.log('Response text:', text);

                let result;
                try {
                    result = JSON.parse(text);
                } catch (e) {
                    throw new Error('Response kh√¥ng ph·∫£i JSON: ' + text);
                }

                resultDiv.className = 'result success';
                resultDiv.textContent = '‚úÖ POST Request th√†nh c√¥ng!\n\n' +
                    'Status: ' + response.status + '\n' +
                    'Response:\n' + JSON.stringify(result, null, 2) + '\n\n' +
                    'üëâ Ki·ªÉm tra Google Sheet ƒë·ªÉ xem d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c th√™m ch∆∞a!';

            } catch (error) {
                console.error('POST Error:', error);
                resultDiv.className = 'result error';
                resultDiv.textContent = '‚ùå POST Request th·∫•t b·∫°i!\n\n' +
                    'Error: ' + error.message + '\n\n' +
                    'Chi ti·∫øt:\n' + error.stack;
            }
        }

        // M·ªü API trong browser
        function openApiInBrowser() {
            window.open(API_URL, '_blank');
        }

        // Log API URL khi trang load
        console.log('=== DEBUG INFO ===');
        console.log('API URL:', API_URL);
        console.log('Current page:', window.location.href);
    </script>
</body>

</html>